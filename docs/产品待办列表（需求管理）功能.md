# 产品待办列表（需求管理）功能说明

## 功能概述

产品待办列表（Product Backlog）是敏捷开发中的核心组件，用于管理项目的所有需求。该功能模块允许团队添加、编辑、删除和跟踪产品需求，支持需求的优先级排序、状态跟踪和进度管理。

## 数据模型

### ProductBacklog 模型
```python
class ProductBacklog(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    requirement_id = db.Column(db.String(32), unique=True, nullable=True)  # 需求编号
    title = db.Column(db.String(256), nullable=False)  # 需求标题
    description = db.Column(db.Text, nullable=True)  # 需求描述
    requirement_type = db.Column(db.String(32), nullable=True)  # 需求类型
    customer_owner_id = db.Column(db.Integer, db.ForeignKey('user.id'), nullable=True)  # 需求责任人（甲方）
    priority = db.Column(db.String(8), default='P3')  # 需求优先级（PO-P5)
    created_at = db.Column(db.DateTime, default=datetime.utcnow)  # 需求提出日期
    status = db.Column(db.String(32), default='待讨论')  # 需求状态
    project_id = db.Column(db.Integer, db.ForeignKey('project_info.id'), nullable=True)  # 需求所属项目
    analyst_id = db.Column(db.Integer, db.ForeignKey('user.id'), nullable=True)  # 需求分析人员
    progress = db.Column(db.String(32), default='未处理')  # 需求执行进度
    related_info = db.Column(db.Text, nullable=True)  # 关联信息
    tags = db.Column(db.String(256), nullable=True)  # 标签
    updated_at = db.Column(db.DateTime, default=datetime.utcnow, onupdate=datetime.utcnow)
```


## 主要功能

### 1. 需求列表展示
- 展示所有产品待办事项，按创建时间倒序排列
- 支持按项目、优先级、状态和关键词进行筛选
- 表格显示需求编号、标题、类型、责任人、优先级、状态、所属项目和创建时间

### 2. 需求添加
- 提供添加需求的模态框表单
- 必填字段：需求标题
- 可选字段：需求描述、需求类型、所属项目、责任人、分析人员、优先级、状态、执行进度、关联信息和标签
- 自动生成唯一需求编号（格式：R_序号）

### 3. 需求编辑
- 点击编辑按钮可修改需求信息
- 支持修改所有需求字段
- 实时保存修改内容

### 4. 需求删除
- 支持删除不需要的需求
- 删除前进行确认提示

### 5. 数据导入/导出
- 支持将需求列表导出为Excel文件
- 支持从Excel文件导入需求数据
- Excel格式包含所有需求字段

## 界面设计

### 主界面
- 顶部导航栏包含功能菜单
- 标题区域显示"产品待办事项"
- 操作按钮：导出需求、导入需求、添加需求
- 筛选区域：项目、优先级、状态、关键词筛选
- 需求列表表格展示所有需求

### 添加/编辑模态框
- 表单字段包括：
  - 需求标题（必填）
  - 需求描述
  - 需求类型（下拉选择：用户故事、Bug修复、技术优化、研究任务、其他）
  - 所属项目（下拉选择）
  - 责任人（下拉选择）
  - 分析人员（下拉选择）
  - 优先级（下拉选择：P0-P5）
  - 状态（下拉选择：待讨论、已澄清、已纳入冲刺、已完成）
  - 执行进度（下拉选择：未处理、分析中、已确认、开发中、测试中、验收中、已上线）
  - 关联信息
  - 标签

### 导入模态框
- 文件选择器用于选择Excel文件
- 支持的文件格式：.xlsx
- 导入按钮执行导入操作

## 权限控制

- 只有具有"product_backlog.product_backlog"权限的用户可以访问该功能
- 使用装饰器进行权限检查
- 无权限用户将被重定向到首页

## API 接口

### 获取需求列表
- 路径：`/product_backlog`
- 方法：GET
- 功能：展示产品待办事项列表页面

### 添加需求
- 路径：`/product_backlog/add`
- 方法：POST
- 参数：所有需求字段
- 返回：JSON格式的成功/失败信息

### 获取单个需求
- 路径：`/product_backlog/get/<int:backlog_id>`
- 方法：GET
- 返回：JSON格式的需求详细信息

### 编辑需求
- 路径：`/product_backlog/edit/<int:backlog_id>`
- 方法：POST
- 参数：所有可编辑的需求字段
- 返回：JSON格式的成功/失败信息

### 删除需求
- 路径：`/product_backlog/delete/<int:backlog_id>`
- 方法：POST
- 返回：JSON格式的成功/失败信息

### 导出需求
- 路径：`/product_backlog/export`
- 方法：GET
- 返回：Excel文件下载

### 导入需求
- 路径：`/product_backlog/import`
- 方法：POST
- 参数：Excel文件
- 返回：JSON格式的成功/失败信息

## 数据字段说明

| 字段名 | 类型 | 说明 |
|--------|------|------|
| requirement_id | String(32) | 需求编号，自动生成 |
| title | String(256) | 需求标题，必填 |
| description | Text | 需求详细描述 |
| requirement_type | String(32) | 需求类型（用户故事、Bug修复等） |
| customer_owner_id | Integer | 责任人ID（甲方） |
| priority | String(8) | 优先级（P0-P5，默认P3） |
| created_at | DateTime | 创建时间 |
| status | String(32) | 需求状态（待讨论、已澄清等） |
| project_id | Integer | 所属项目ID |
| analyst_id | Integer | 分析人员ID |
| progress | String(32) | 执行进度（未处理、分析中等） |
| related_info | Text | 关联信息 |
| tags | String(256) | 标签 |

## 优先级说明

- P0: 最高优先级
- P1: 很高优先级
- P2: 高优先级
- P3: 中等优先级（默认）
- P4: 低优先级
- P5: 最低优先级

## 状态说明

- 待讨论: 需求刚提出，尚未详细分析
- 已澄清: 需求已明确，具备开发条件
- 已纳入冲刺: 需求已加入迭代计划
- 已完成: 需求已开发完成并验收

## 进度说明

- 未处理: 需求刚提出
- 分析中: 正在分析需求细节
- 已确认: 需求已确认，等待开发
- 开发中: 正在开发中
- 测试中: 正在测试中
- 验收中: 正在验收中
- 已上线: 已完成并上线

该文档已整理完成并保存为Markdown格式。